/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package frontend;

import java.awt.GridLayout;
import javax.swing.JComboBox;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JPasswordField;
import javax.swing.JTextField;
import seguridad.ControlRegistro;
import seguridad.Usuario;

/**
 *
 * @author MISAEL JIMENEZ (frontend) DAVID VELAZQUEZ (backend y seguridad)
 */
public class frmTerminos extends javax.swing.JFrame {

     private frmInicio ventanaPadre; // Referencia a la ventana de inicio
    /**
     * Creates new form frmTerminos
     */
    public frmTerminos() {
        initComponents();
    }
    
     // Constructor que recibe la ventana padre
    public frmTerminos(frmInicio padre) {
        initComponents();
        this.ventanaPadre = padre;
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        txtaTerminos = new javax.swing.JTextArea();
        chkMantenerS = new javax.swing.JCheckBox();
        jLabel2 = new javax.swing.JLabel();
        btnContinuar = new javax.swing.JButton();
        jLabel3 = new javax.swing.JLabel();
        btnRegresar = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setUndecorated(true);
        setResizable(false);
        getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        txtaTerminos.setEditable(false);
        txtaTerminos.setColumns(20);
        txtaTerminos.setRows(5);
        txtaTerminos.setText("1. Aceptación de los Términos Al utilizar el Sistema de Inventario para Bodegas y Almacenes (SIBAL), \ndesarrollado por el equipo académico compuesto por David Velazquez, Misael Jiménez, Alexander Soláres y Víctor Gonzáles, usted acepta \nestar sujeto a estos Términos y Condiciones. Si no está de acuerdo con alguna parte de estos términos, \nno deberá utilizar el sistema. \n\n2. Descripción del Servicio SIBAL: Es una aplicación de escritorio desarrollada en Java con la arquitectura\nModelo-Vista-Controlador (MVC), diseñada para la gestión de inventarios en bodegas y \nalmacenes. Incluye funcionalidades como registro de usuarios, proveedores, productos, categorías, \nmovimientos de inventario y generación de reportes. Este software se ejecuta en un entorno local con \nbase de datos MySQL y fue creado como parte de un proyecto académico en Apache NetBeans. \n\n3. Licencia de Uso  SIBAL: se proporciona bajo una licencia de uso no comercial, exclusiva para fines \neducativos y de aprendizaje. El software no puede ser distribuido, vendido, modificado o utilizado con \nfines comerciales sin el consentimiento expreso del equipo desarrollador. Los usuarios tienen derecho \na utilizar el sistema únicamente en el contexto del proyecto académico para el cual fue desarrollado.  \n\n4. Registro y Seguridad:  El acceso al sistema requiere un registro de usuario con un nombre de usuario\ny contraseña, los cuales deben ser únicos y seguros. Los usuarios son responsables de mantener la \nconfidencialidad de sus credenciales. Cualquier actividad realizada bajo su cuenta será de su exclusiva \nresponsabilidad. La contraseña se almacena en la base de datos utilizando encriptación (SHA-256) para \ngarantizar la seguridad de los datos.  \n\n5. Responsabilidades del Usuario:  Los usuarios deben utilizar SIBAL de manera ética y conforme a las \nleyes aplicables, evitando el acceso no autorizado o la manipulación de datos. \nEstá prohibido introducir datos falsos, maliciosos o que puedan afectar el funcionamiento del sistema. \nEl equipo desarrollador no se hace responsable por pérdidas de datos derivadas de un uso indebido o \nfalta de respaldo por parte del usuario.  \n\n6. Propiedad Intelectual:  Todos los derechos de propiedad intelectual de SIBAL, incluyendo el código \nfuente, diseño de la interfaz, logo y documentación, pertenecen al equipo desarrollador \n(David, Misael, Alexander, Víctor). Cualquier reproducción, distribución o uso del software o sus \ncomponentes requiere autorización previa.  \n\n7. Limitación de Responsabilidad: SIBAL se proporciona \"tal cual\", sin garantías de ningún tipo, ya sea \nexpresa o implícita, incluyendo, pero no limitándose a, garantías de comerciabilidad o idoneidad para\nun propósito particular. El equipo desarrollador no será responsable por daños directos, indirectos,\nincidentales o consecuentes derivados del uso o incapacidad de usar el sistema.  \n\n8. Modificaciones y Actualizaciones: El equipo desarrollador se reserva el derecho de modificar, \nsuspender o discontinuar SIBAL en cualquier momento sin previo aviso, especialmente en el contexto \ndel desarrollo académico. \nLos usuarios serán notificados de cambios significativos a través de los canales establecidos \n(ej. documentación en el repositorio GitHub).  \n\n9. Privacidad de Datos: Los datos ingresados en SIBAL (usuarios, proveedores, productos, movimientos)\nse almacenan localmente en una base de datos MySQL gestionada por el usuario. \nEl equipo desarrollador no recopila ni almacena datos de los usuarios fuera del entorno local, salvo \nque se especifique lo contrario para fines académicos con consentimiento expreso. Los usuarios son \nresponsables de cumplir con las normativas de protección de datos aplicables en su jurisdicción.  \n\n10. Resolución de Conflictos: Cualquier disputa relacionada con el uso de SIBAL se resolverá de manera\namistosa entre las partes involucradas. En caso de no llegar a un acuerdo, se someterá a las leyes donde\nse desarrolla el proyecto (Cecyt 8) .  \n11. Contacto: Para preguntas, sugerencias o reportes relacionados con SIBAL, los usuarios pueden \ncontactar al equipo desarrollador a través de los canales establecidos en la documentación del \nproyecto (ej. correo electrónico o repositorio GitHub). \n\n\nFecha de entrada en vigor: [08 de Noviembre de 2025].");
        jScrollPane1.setViewportView(txtaTerminos);

        chkMantenerS.setText("Aceptar terminos y condiciones");

        jLabel2.setFont(new java.awt.Font("Segoe UI", 1, 24)); // NOI18N
        jLabel2.setText("TERMINOS Y CONDICIONES");

        btnContinuar.setText("CONTINUAR");
        btnContinuar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnContinuarActionPerformed(evt);
            }
        });

        jLabel3.setFont(new java.awt.Font("Segoe UI", 1, 24)); // NOI18N
        jLabel3.setText("S  I  B  A  L");

        btnRegresar.setText("REGRESAR");
        btnRegresar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnRegresarActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addContainerGap(22, Short.MAX_VALUE)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 558, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(20, 20, 20))
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(204, 204, 204)
                        .addComponent(chkMantenerS))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(141, 141, 141)
                        .addComponent(jLabel2))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(236, 236, 236)
                        .addComponent(jLabel3)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(88, 88, 88)
                .addComponent(btnRegresar)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btnContinuar)
                .addGap(89, 89, 89))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel2)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel3)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 8, Short.MAX_VALUE)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 362, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(chkMantenerS)
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnContinuar)
                    .addComponent(btnRegresar))
                .addContainerGap())
        );

        getContentPane().add(jPanel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 600, 530));

        pack();
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void btnContinuarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnContinuarActionPerformed
        // Verificar si aceptó los términos
        if (!chkMantenerS.isSelected()) {
            JOptionPane.showMessageDialog(
                this,
                "Debes aceptar los términos y condiciones para continuar",
                "Términos requeridos",
                JOptionPane.WARNING_MESSAGE
            );
            return;
        }
        
        // Cerrar ventana de términos
        this.dispose();
        
        // Mostrar mensaje de aceptación
        JOptionPane.showMessageDialog(
            ventanaPadre,
            "Has aceptado los Términos y Condiciones de SIBAL.\n" +
            "Ahora puedes proceder con el registro de tu cuenta.",
            "Términos Aceptados",
            JOptionPane.INFORMATION_MESSAGE
        );
        
        // Proceder con el registro
        mostrarFormularioRegistro();

    }//GEN-LAST:event_btnContinuarActionPerformed

    private void btnRegresarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnRegresarActionPerformed
        frmInicio inicio = new frmInicio();
        inicio.setVisible(true);
        this.dispose();
        
    }//GEN-LAST:event_btnRegresarActionPerformed

    private void mostrarFormularioRegistro() {
        // Crear panel personalizado para registro
        JPanel panel = new JPanel(new GridLayout(5, 2, 10, 10));
        
        JTextField txtNombre = new JTextField(15);
        JTextField txtUsuario = new JTextField(15);
        JPasswordField txtPassword = new JPasswordField(15);
        JPasswordField txtConfirmPassword = new JPasswordField(15);
        
        // ComboBox para el rol
        String[] roles = {"Encargado", "Administrador"};
        JComboBox<String> cmbRol = new JComboBox<>(roles);
        
        panel.add(new JLabel("Nombre completo:"));
        panel.add(txtNombre);
        panel.add(new JLabel("Usuario:"));
        panel.add(txtUsuario);
        panel.add(new JLabel("Contraseña:"));
        panel.add(txtPassword);
        panel.add(new JLabel("Confirmar contraseña:"));
        panel.add(txtConfirmPassword);
        panel.add(new JLabel("Rol:"));
        panel.add(cmbRol);
        
        int resultado = JOptionPane.showConfirmDialog(
            ventanaPadre, 
            panel, 
            "Crear Cuenta - SIBAL", 
            JOptionPane.OK_CANCEL_OPTION, 
            JOptionPane.PLAIN_MESSAGE
        );
        
        if (resultado == JOptionPane.OK_OPTION) {
            String nombre = txtNombre.getText().trim();
            String usuario = txtUsuario.getText().trim();
            String password = new String(txtPassword.getPassword());
            String confirmPassword = new String(txtConfirmPassword.getPassword());
            String rol = (String) cmbRol.getSelectedItem();
            
            // Validaciones
            if (nombre.isEmpty() || usuario.isEmpty() || password.isEmpty()) {
                JOptionPane.showMessageDialog(
                    ventanaPadre, 
                    "Todos los campos son obligatorios", 
                    "Campos vacíos", 
                    JOptionPane.WARNING_MESSAGE
                );
                return;
            }
            
            if (password.length() < 4) {
                JOptionPane.showMessageDialog(
                    ventanaPadre, 
                    "La contraseña debe tener al menos 4 caracteres", 
                    "Contraseña débil", 
                    JOptionPane.WARNING_MESSAGE
                );
                return;
            }
            
            if (!password.equals(confirmPassword)) {
                JOptionPane.showMessageDialog(
                    ventanaPadre, 
                    "Las contraseñas no coinciden", 
                    "Error", 
                    JOptionPane.ERROR_MESSAGE
                );
                return;
            }
            
            // Crear objeto Usuario
            Usuario nuevoUsuario = new Usuario(nombre, usuario, password, rol);
            
            // Registrar en BD
            ControlRegistro controlRegistro = new ControlRegistro();
            boolean registrado = controlRegistro.registrarUsuario(nuevoUsuario);
            
            if (registrado) {
                JOptionPane.showMessageDialog(
                    ventanaPadre, 
                    "¡Cuenta creada exitosamente!\n" +
                    "Usuario: " + usuario + "\n" +
                    "Rol: " + rol + "\n\n" +
                    "✓ Términos y condiciones aceptados\n" +
                    "Ya puedes iniciar sesión", 
                    "Registro exitoso", 
                    JOptionPane.INFORMATION_MESSAGE
                );
            } else {
                JOptionPane.showMessageDialog(
                    ventanaPadre, 
                    "No se pudo crear la cuenta.\n" +
                    "El usuario podría ya existir.", 
                    "Error de registro", 
                    JOptionPane.ERROR_MESSAGE
                );
            }
        }
    }
    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(frmTerminos.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(frmTerminos.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(frmTerminos.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(frmTerminos.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new frmTerminos().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnContinuar;
    private javax.swing.JButton btnRegresar;
    private javax.swing.JCheckBox chkMantenerS;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTextArea txtaTerminos;
    // End of variables declaration//GEN-END:variables
}
